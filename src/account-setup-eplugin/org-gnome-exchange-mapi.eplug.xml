<?xml version="1.0" encoding="UTF-8"?>
<e-plugin-list>
	<e-plugin type="shlib" location="@PLUGINDIR@/liborg-gnome-exchange-mapi.so" load-on-startup="true" id="org.gnome.evolution.plugin.exchange-mapi" name="Exchange MAPI" system_plugin="true">

		<author name="Srinivasa Ragavan" email="sragavan@novell.com"/>
		<author name="Johnny Jacob" email="jjohnny@novell.com"/>
		<author name="Suman Manjunath" email="msuman@novell.com"/>

		<description>Exchange MAPI Plugin</description>

		<hook class="org.gnome.evolution.mail.config:1.0">
			<group 
				target="settings" 
				id="org.gnome.evolution.mail.config.accountWizard" 
				check="org_gnome_e_mapi_check_options">
				<item 
					type="item_table" 
					path="10.receive/20.config/30.mapi" 
					factory="org_gnome_e_mapi_account_setup"/>
			</group>
		</hook>
		<hook class="org.gnome.evolution.mail.config:1.0">
			<group 
				target="settings" 
				id="org.gnome.evolution.mail.config.accountAssistant" 
				check="org_gnome_e_mapi_check_options">
				<item 
					type="item_table" 
					path="10.receive/20.config/30.mapi" 
					factory="org_gnome_e_mapi_account_setup"/>
			</group>
		</hook>
		<hook class="org.gnome.evolution.mail.config:1.0">
			<group 
				target="settings" 
				id="org.gnome.evolution.mail.config.accountEditor" 
				check="org_gnome_e_mapi_check_options">
				<item 
					type="item_table" 
					path="10.receive/20.config/30.mapi" 
					factory="org_gnome_e_mapi_account_setup"/>
			</group>
		</hook>
		<hook class="org.gnome.evolution.mail.config:1.0">
      		      <group 
			 target="settings" 
			 id="org.gnome.evolution.mail.config.accountEditor"
			 check="org_gnome_e_mapi_check_options">
			<item type="page" 
	      		      path="40.settings"
	      		      _label="Exchange Settings"
	      		      factory="org_gnome_e_mapi_settings"/>
      		      </group>
		</hook>
		<hook class="org.gnome.evolution.addressbook.config:1.0">
			<group 
				target="source" 
				id="com.novell.evolution.addressbook.config.accountEditor" 
				check="e_mapi_book_check" 
				commit="e_mapi_book_commit">
				<item 
					type="item" 
					path="00.general/10.display/50.createcontacts" 
					factory="e_mapi_create_addressbook"/>
			</group>
		</hook>
		<hook class="org.gnome.evolution.calendar.config:1.0">
			<group 
				target="source" 
				id="org.gnome.evolution.calendar.calendarProperties" 
				check="e_mapi_cal_check" 
				commit="e_mapi_cal_commit">
				<item 
					type="item_table" 
					path="00.general/10.source/40.pcalendar" 
					factory="e_mapi_create_calendar"/>
			</group>
		</hook>

		<hook class="org.gnome.evolution.mail.popup:1.0">
			<menu id="org.gnome.evolution.mail.foldertree.popup" target="folder"
				factory="org_gnome_folder_size_display_popup">
			</menu>
		</hook>

		<hook class="org.gnome.evolution.ui:1.0">
		  <ui-manager id="org.gnome.evolution.mail" callback="mapi_ui_init_mail">
		    <popup name="mail-folder-popup">
		      <placeholder name="mail-folder-popup-actions">
			<menuitem action="mail-mapi-folder-size"/>
			<menuitem action="mail-mapi-subscribe-foreign-folder"/>
			<menuitem action="mail-mapi-folder-permissions"/>
		      </placeholder>
		    </popup>
		  </ui-manager>

		  <ui-manager id="org.gnome.evolution.calendars" callback="mapi_ui_init_calendar">
		    <popup name="calendar-popup">
		      <placeholder name="calendar-popup-actions">
			<menuitem action="calendar-mapi-folder-permissions"/>
		      </placeholder>
		    </popup>
		  </ui-manager>
		  <ui-manager id="org.gnome.evolution.tasks" callback="mapi_ui_init_tasks">
		    <popup name="task-list-popup">
		      <placeholder name="task-list-popup-actions">
			<menuitem action="tasks-mapi-folder-permissions"/>
		      </placeholder>
		    </popup>
		  </ui-manager>
		  <ui-manager id="org.gnome.evolution.memos" callback="mapi_ui_init_memos">
		    <popup name="memo-list-popup">
		      <placeholder name="memo-list-popup-actions">
			<menuitem action="memos-mapi-folder-permissions"/>
		      </placeholder>
		    </popup>
		  </ui-manager>
		  <ui-manager id="org.gnome.evolution.contacts" callback="mapi_ui_init_contacts">
		    <popup name="address-book-popup">
		      <placeholder name="address-book-popup-actions">
			<menuitem action="contacts-mapi-folder-permissions"/>
		      </placeholder>
		    </popup>
		  </ui-manager>
		</hook>
	</e-plugin>
</e-plugin-list>
