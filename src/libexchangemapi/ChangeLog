2009-06-24  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_profile): Added support
	for ProcessNetworkProfile callback data.

2009-07-17  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_get_folders_list): Get size for mailbox.

2009-07-13  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (get_child_folders): Fetch PR_MESSAGE_SIZE
	from folders.

	* exchange-mapi-folder.h (_ExchangeMAPIFolder): Added folder size field.

2009-07-15  Bharath Acharya  <abharath@novell.com>

	** Fixes Bug 585972 - EDS crash : trying to create meeting with attachment

	* src/libexchangemapi/exchange-mapi-cal-utils.c: The filename has to
	be included from the date format instead of fetching the basename of
	the file alone.

2009-06-22  Johnny Jacob  <jjohnny@novell.com>

	** Fixes Bug 585641 – evolution-mapi stores cleartext passwords in a world readable file

	* exchange-mapi-connection.c (exchange_mapi_create_profile): Do not save
	the password in mapi-profiles.ldb.

2009-06-09  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (mapi_profile_load): Added MAPI_DEBUG.
	Exporting MAPI_DEBUG=1 prints libmapi's logs and internal data state.
	This would dump too much information, but helps in debugging.

2009-06-03  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (get_child_folders): Updated to accomodate traversal
	depth.
	(exchange_mapi_get_folders_list): update for get_child_folders.
	(exchange_mapi_get_pf_folders_list): If parent_id is given, use that as
	the start of folder tree..

2009-04-07  Milan Crha  <mcrha@redhat.com>

	* exchange-mapi-connection.c: (mapi_profile_load):
	Compiler warning fix.

2009-04-01  Julien Kerihuel <j.kerihuel@openchange.org>
	* Add generated files to the svn ignore list
	
	* Fix Do not call MAPIUninitialize if whether profile store
	creation or MAPIInitialize fails.
	
2009-03-19  Milan Crha  <mcrha@redhat.com>

	** Fix for bug #574784

	* exchange-mapi-connection.c: (exchange_mapi_util_check_restriction),
	(exchange_mapi_connection_fetch_items), (exchange_mapi_empty_folder),
	(exchange_mapi_connection_fetch_item), (exchange_mapi_create_folder),
	(exchange_mapi_remove_folder), (exchange_mapi_remove_folder),
	(get_child_folders):
	* exchange-mapi-utils.c: (exchange_mapi_util_mapi_id_to_string),
	(exchange_mapi_util_mapi_id_from_string),
	(exchange_mapi_util_mapi_ids_to_uid),
	(exchange_mapi_util_mapi_ids_from_uid),
	(exchange_mapi_debug_property_dump):
	* exchange-mapi-folder.c: (exchange_mapi_folder_get_folder):
	Use proper formatting modifier for IDs.

2009-02-20  Milan Crha  <mcrha@redhat.com>

	* exchange-mapi-cal-utils.c:
	* exchange-mapi-connection.c:
	* exchange-mapi-utils.c:
	* exchange-mapi-cal-recur-utils.c:
	* exchange-mapi-folder.c: Fix for compiler warnings.

2009-02-16  Johnny Jacob  <jjohnny@novell.com>

	** Fixes #568519 – Delete/Renaming default folders should not be allowed.

	* exchange-mapi-connection.c (set_default_folders): Use PR_REN_ADDITIONAL_ENTRYIDS for
	Junk & Sync issues folder.
	(mapi_get_ren_additional_fids): Added. Fetch Use PR_REN_ADDITIONAL_ENTRYIDS.

2009-02-13  Wang Xin  <jedy.wang@sun.com>

	** Fix for bug #571413. Use G_STRLOC and G_STRFUNC to replace __FILE__,
	__LINE__ and __PRETTY_FUNCTION__.

	* exchange-mapi-cal-tz-utils.c:
	* exchange-mapi-connection.c:
	* exchange-mapi-folder.c:

2009-02-05  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_get_folders_list): Mark 'Mailbox (name)' as
	olTopInformationStore.
	(exchange_mapi_get_pf_folders_list): Mark 'All Public Folders' as olFolderPublicRoot.

2009-02-04  Milan Crha  <mcrha@redhat.com>

	** Fix for bug #569482

	* Makefile.am: Removed obsolete lines and use
	EVO_MAPI_API_VERSION variable.

2009-02-02  Suman Manjunath  <msuman@novell.com>

	** Part of fix for bug #568554

	* exchange-mapi-cal-tz-utils.c
	(exchange_mapi_cal_tz_util_dump_ical_tzs): Fix for compiler warnings
	introduced after the libical fork was dropped. 

2009-01-28  Johnny Jacob  <jjohnny@novell.com>

	** Fixes #569246. Patch by Jelmer Vernooij <jelmer@samba.org>

	* exchange-mapi-cal-recur-utils.c:
	* exchange-mapi-utils.c:
	* exchange-mapi-folder.c:
	* exchange-mapi-connection.c:
	* exchange-mapi-cal-utils.c:
	* exchange-mapi-cal-tz-utils.c: Include config.h

2009-01-28  Milan Crha  <mcrha@redhat.com>

	** Fix for bug #564897

	* Makefile.am:
	* exchange-mapi-connection.h: (exchange_mapi_create_profile),
	(exchange_mapi_delete_profile):
	* exchange-mapi-connection.c: (manage_mapi_error),
	(exchange_mapi_create_profile), (exchange_mapi_delete_profile):
	Move create/delete profile function here, and hold a connect
	lock when inside them.

2009-01-24  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_items): Mem leak : Do not
	allocate memory for lpProps.

2009-01-21  Suman Manjunath  <msuman@novell.com>

	** Fix for bug #541209

	** Adapt to the new APIs from upstream libical. Changes made include
	using the "_r" counterpart for the following APIs:
	+ icalproperty_as_ical_string ()
	+ icalvalue_as_ical_string ()
	+ icalcomponent_as_ical_string ()
	+ icalparameter_as_ical_string ()
	+ icaldurationtype_as_ical_string ()
	+ icalenum_reqstat_code ()
	+ icallangbind_property_eval_string ()
	+ icallangbind_quote_as_ical ()
	+ icalmime_text_end_part ()
	+ icalperiodtype_as_ical_string ()
	+ icalproperty_enum_to_string ()
	+ icalproperty_get_parameter_as_string ()
	+ icalproperty_get_value_as_string ()
	+ icalproperty_get_property_name ()
	+ icalrecurrencetype_as_string ()
	+ icaltime_as_ical_string ()
	+ icalreqstattype_as_string ()
	+ icalvalue_binary_as_ical_string ()
	+ icalvalue_int_as_ical_string ()
	+ icalvalue_utcoffset_as_ical_string ()
	+ icalvalue_string_as_ical_string ()
	+ icalvalue_recur_as_ical_string ()
	+ icalvalue_text_as_ical_string ()
	+ icalvalue_attach_as_ical_string ()
	+ icalvalue_duration_as_ical_string ()
	+ icalvalue_date_as_ical_string ()
	+ icalvalue_datetime_as_ical_string ()
	+ icalvalue_float_as_ical_string ()
	+ icalvalue_geo_as_ical_string ()
	+ icalvalue_datetimeperiod_as_ical_string ()
	+ icalvalue_period_as_ical_string ()
	+ icalvalue_trigger_as_ical_string ()
	+ icalvalue_as_ical_string ()

	* exchange-mapi-cal-recur-utils.c
	(exchange_mapi_cal_util_rrule_to_bin):
	* exchange-mapi-cal-utils.c (exchange_mapi_cal_util_camel_helper):

2009-01-09  Johnny Jacob  <jjohnny@novell.com>

	** Fixes #566883.
	
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_items): QueryPosition
	is not gauranteed to return the requested number of results. so we need to track 
	current cursor position and iterate through the table.

2008-12-23  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (ical_attendees_from_props): Always add the
	PARTSTAT and ROLE properties (by using default values when properties
	are missing). Should resolve bug #450850 (bugzilla.novell.com)

2008-12-16  Matthew Barnes  <mbarnes@redhat.com>

	** Fixes part of bug #564553

	* exchange-mapi-cal-utils.c (exchange_mapi_cal_build_props):
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_items):
	Fix compiler warnings.

2008-12-02  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.[ch] (exchange_mapi_connection_fetch_items): Enable
	Sorting.

2008-12-01  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_items): When
	callback returns false return from the API.

2008-11-28  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c
	(exchange_mapi_util_modify_recipients): Save some CPU cycles.

2008-11-28  Suman Manjunath  <msuman@novell.com>

	** Fix for bug #562202

	* exchange-mapi-connection.c
	(exchange_mapi_util_modify_recipients): Allocate memory, if not done
	already, before	attempting to increase the size of the SRowSet.

2008-11-24  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_recipients): Fixes for sending
	meeting requests to recipients not in GAL.
	* exchange-mapi-connection.c (set_recipient_properties),
	(exchange_mapi_util_modify_recipients): Set properties for
	recipients as required by the backends instead of a pre-defined
	set, also prevent setting the entry-id property for now as it 
	creates problems.

2008-11-24  Suman Manjunath  <msuman@novell.com>

	** Fix for bug #561640

	* exchange-mapi-connection.c (exchange_mapi_util_set_attachments):
	Send the right flags to SaveChangesAttachment()

2008-11-24  Julien Kerihuel  <j.kerihuel@openchange.org>

	Fix recipient related functions: sending emails to 
	EX or SMTP users work.

	FIXME: The SetRecipientType function only uses 
	MAPI_TO at the moment (hardcoded).
	Can someone have a look and fix this call so we use 
	the correct recipient class instead?
	(MAPI_TO, MAPI_CC or MAPI_BCC).

	* exchange-mapi-connection.c (set_recipient_properties),
	(exchange_mapi_util_modify_recipients):

2008-11-24  Julien Kerihuel  <j.kerihuel@openchange.org>

	- This commit makes evolution-mapi work with libmapi-0.8 
	  latest trunk revision
	- exchange_mapi_util_ex_to_smtp temporarily moved to 
	  exchange-mapi-connection.c to use global_mapi_session
	- various g_byte_array_append cast warnings fixed

	Note: the current commit breaks the "set recipients" related 
	routines and will be fixed in a further commit.

	* exchange-mapi-cal-recur-utils.c
	(exchange_mapi_cal_util_bin_to_rrule),
	(exchange_mapi_cal_util_rrule_to_bin):
	* exchange-mapi-cal-tz-utils.c
	(exchange_mapi_cal_util_mapi_tz_to_bin):
	* exchange-mapi-cal-tz-utils.h:
	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_generate_globalobjectid),
	(exchange_mapi_cal_util_mapi_props_to_comp),
	(update_server_object), (exchange_mapi_cal_util_build_props):
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-connection.c
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_get_attachments), (set_recipient_properties),
	(exchange_mapi_util_modify_recipients),
	(exchange_mapi_util_check_restriction),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_empty_folder),
	(exchange_mapi_remove_folder), (exchange_mapi_rename_folder),
	(exchange_mapi_util_resolve_named_props),
	(exchange_mapi_util_resolve_named_prop),
	(exchange_mapi_util_create_named_prop),
	(exchange_mapi_get_default_folder_id), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (exchange_mapi_set_flags),
	(mapi_move_items), (exchange_mapi_remove_items),
	(set_default_folders), (set_owner_name), (set_user_name),
	(exchange_mapi_get_folders_list),
	(exchange_mapi_get_pf_folders_list),
	(exchange_mapi_util_ex_to_smtp):
	* exchange-mapi-utils.c (exchange_mapi_debug_property_dump),
	(exchange_mapi_util_bin_append_uint16),
	(exchange_mapi_util_bin_append_uint32),
	(exchange_mapi_util_bin_append_string),
	(exchange_mapi_util_bin_append_unicode),
	(exchange_mapi_util_bin_append_val),
	(exchange_mapi_util_entryid_generate_oneoff),
	(exchange_mapi_util_entryid_generate_local):
	* exchange-mapi-utils.h:

2008-11-21  Suman Manjunath  <msuman@novell.com>

	** Fixes for bug #560465 and bug #560764

	* exchange-mapi-cal-utils.c (fetch_server_data_cb): Fix the callback 
	signature.
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item):
	Release the mapi_objects before the callback. 

2008-11-19  Suman Manjunath  <msuman@novell.com>

	* Makefile.am: Some cleanup. 
	* libexchangemapi.pc.in: Fixed AC substitutions, make it more sensible.

2008-11-17  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_close): 
	Lock the session before attempting to close the MAPI session. 
	* exchange-mapi-folder.c (exchange_mapi_peek_folder_list): Remove
	the beep from the warning ;-)

2008-11-03  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item):
	Fixed a typo. 

2008-10-29  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item)
	(exchange_mapi_connection_fetch_items): Using FetchItemsCallbackData.

	* exchange-mapi-connection.h (FetchItemsCallbackData): Added.
	Changed FetchCallback to use FetchItemsCallbackData.

2008-10-10  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (set_default_folders): Use IsMailboxFolder for
	marking / identifying default folders.

2008-10-07  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_util_read_body_stream): Ignoring 
	PR_BODY_HTML_UNICODE.

2008-09-19  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_folder),
	(exchange_mapi_set_flags), (mapi_move_items),
	(exchange_mapi_copy_items), (exchange_mapi_move_items),
	(get_child_folders), (exchange_mapi_get_folders_list),
	(exchange_mapi_get_pf_folders_list): Lots of code cleanup. 
	* exchange-mapi-folder.c (exchange_mapi_folder_new):
	* exchange-mapi-folder.h: Don't store parent-folder-name in 
	ExchangeMAPIFolder - it's of no real use. Related changes. 

2008-09-08  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_get_pf_folders_list): Renamed
	'Public Folders' to 'All Public Folders'.

2008-09-05  Suman Manjunath  <msuman@novell.com>

	** Support for recurring appointments. Create/Modify all/Delete 
	operations are supported. Modify single instance is not implemented. 

	* Makefile.am:
	* exchange-mapi-cal-recur-utils.c (get_ical_weekstart),
	(get_mapi_weekstart), (get_mapi_day), (get_ical_pos),
	(get_mapi_pos), (convert_recurrence_minutes_to_date),
	(convert_date_to_recurrence_minutes), (convert_filetime_to_timet),
	(convert_timet_to_filetime), (convert_recurrence_minutes_to_timet),
	(convert_timet_to_recurrence_minutes), (check_calendar_type),
	(exchange_mapi_cal_util_bin_to_rrule), (compute_startdate),
	(compute_rdaily_firstdatetime), (compute_rweekly_firstdatetime),
	(compute_rmonthly_firstdatetime), (calculate_no_of_occurrences),
	(compare_guint32), (exchange_mapi_cal_util_rrule_to_bin):
	* exchange-mapi-cal-recur-utils.h:
	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_mapi_props_to_comp),
	(update_attendee_status), (appt_build_name_id),
	(exchange_mapi_cal_util_build_props):

	* exchange-mapi-cal-utils.h: Don't fetch PR_BODY_HTML 
	* exchange-mapi-connection.c 
	(exchange_mapi_util_set_attachments): Typo fix. 
	(exchange_mapi_modify_item): API change, accept streams just like 
	exchange_mapi_create_item(). 
	* exchange-mapi-connection.h: Fix for API change. 

2008-09-02  Johnny Jacob  <jjohnny@novell.com>	
	
	* exchange-mapi-connection.c (exchange_mapi_set_flags): PFSTORE aware.
	
2008-08-27  Suman Manjunath  <msuman@novell.com>
	
	** Upgrade to LibMAPI r700

	* exchange-mapi-connection.c
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_set_attachments):

2008-08-27  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (get_prio_prop_from_priority),
	(get_imp_prop_from_priority),
	(exchange_mapi_cal_util_fetch_attachments),
	(exchange_mapi_cal_util_fetch_organizer),
	(exchange_mapi_cal_util_fetch_recipients),
	(exchange_mapi_cal_util_mapi_props_to_comp),
	(exchange_mapi_cal_util_build_name_id), (note_build_name_id),
	(exchange_mapi_cal_util_build_props):
	- Don't set string properties in UNICODE since it seems to be buggy
	- Fixes for rendering / create / modify tasks. 

2008-08-27  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_util_read_body_stream): 
	Don't cast to SRow structure while fetching body stream - trivial. 
	* exchange-mapi-utils.c (exchange_mapi_debug_property_dump): Dump 
	binary streams, some minor type cast fixes. 

2008-08-25  Suman Manjunath  <msuman@novell.com>

	** Prefer fetching/setting UNICODE strings over ANSI C strings.

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_attachments),
	(exchange_mapi_cal_util_fetch_organizer),
	(exchange_mapi_cal_util_fetch_recipients),
	(exchange_mapi_cal_util_generate_globalobjectid),
	(exchange_mapi_cal_util_mapi_props_to_comp),
	(update_attendee_status), (appt_build_name_id),
	(exchange_mapi_cal_util_build_props):
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-connection.c (exchange_mapi_util_read_body_stream),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item):
	* exchange-mapi-utils.c
	(exchange_mapi_util_find_SPropVal_array_propval),
	(exchange_mapi_util_find_row_propval),
	(exchange_mapi_util_find_array_propval):

2008-08-22  Suman Manjunath  <msuman@novell.com>

	** Extensive rewrite of ExchangeMAPIAttachment handling. It provides
	infrastructure for having various modes of attachment. Also, re-uses 
	a lot of existing code and pushes setting the attachment-specific 
	details to the backends, thereby making it extremely flexible. 
	Some minor code-cleanups included. 

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_attachments),
	(set_attachments_to_cal_component):
	* exchange-mapi-connection.c (mapi_profile_load),
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_util_write_generic_streams),
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments),
	(exchange_mapi_util_get_recipients), (exchange_mapi_create_item),
	(mapi_move_items):
	* exchange-mapi-connection.h:
	* exchange-mapi-folder.c (exchange_mapi_folder_new),
	(exchange_mapi_folder_get_folder):
	* exchange-mapi-folder.h:
	* exchange-mapi-utils.c (exchange_mapi_util_free_attachment_list):

2008-08-21  Johnny Jacob  <jjohnny@novell.com>
	
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_items): Open PF 
	store if mentioned.
	
2008-08-21  Suman Manjunath  <msuman@novell.com>

	Patch from Patrick Ohly  <patrick.ohly@gmx.de>
	* Makefile.am: Include necessary directories for compiling out-of-tree.
	* exchange-mapi-cal-utils.h: Don't include 
	"exchange-mapi-cal-recur-utils.h" for now. 

2008-08-19  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (exchange_mapi_cal_util_build_props): Minor
	issue with handling alarms. 
	* exchange-mapi-utils.c
	(exchange_mapi_util_find_SPropVal_array_propval),
	(exchange_mapi_util_find_row_propval),
	(exchange_mapi_util_find_array_propval):
	* exchange-mapi-utils.h: 
	Fixed a few potential invalid memory accesses. 

2008-08-19  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (get_partstat_from_trackstatus),
	(exchange_mapi_cal_util_fetch_organizer), (update_attendee_status),
	(update_server_object), (exchange_mapi_cal_util_camel_helper),
	(appt_build_name_id), (note_build_name_id),
	(exchange_mapi_cal_util_build_props):
	* exchange-mapi-cal-utils.h: 
	Support for accept/decline from mail folders, related changes. 

2008-08-14  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_attachments),
	(set_attachments_to_cal_component), (change_partstat),
	(exchange_mapi_cal_util_camel_helper),
	(exchange_mapi_cal_util_build_props): Fixes for some corner case
	scenarios while rendering/updating meeting replies. Fixes for sending
	receiving attachments which was broken sometime ago (LF-CRLF). 

2008-08-13  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c
	(exchange_mapi_util_modify_recipients),
	(exchange_mapi_create_item), (exchange_mapi_modify_item): Use 
	RemoveAllRecipients() before setting RecipientTable in a modify_item 
	call. 
	* exchange-mapi-connection.h: Minor typo fix. 

2008-08-12  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (fetch_server_data_cb),
	(fetch_server_data), (update_attendee_status),
	(update_server_object), (check_server_for_object),
	(exchange_mapi_cal_util_camel_helper): More code re-organization. 
	* exchange-mapi-cal-utils.h: Fetch PR_MSG_EDITOR_FORMAT.

2008-08-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (get_partstat_from_trackstatus),
	(get_trackstatus_from_partstat),
	(exchange_mapi_cal_util_fetch_recipients), (change_partstat),
	(remove_other_attendees), (update_cb), (update_attendee_status),
	(exchange_mapi_cal_util_camel_helper),
	(exchange_mapi_cal_util_build_props): Initial code for rendering meeting
	responses, some cleanups. 
	* exchange-mapi-defs.h: Added a few IPM_* strings. 

2008-08-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_util_read_body_stream),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): Use MAPI_OPTIONS_GETBESTBODY. 
	* exchange-mapi-connection.h: Added MAPI_OPTIONS_GETBESTBODY. 

2008-08-01  Johnny Jacob  <jjohnny@novell.com>
	
	* exchange-mapi-connection.c (exchange_mapi_util_read_body_stream): Use
	GetBestBody instead of PR_MSG_EDITOR_FORMAT.

2008-07-31  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (set_recipient_properties): Some
	extra validation checks. 

2008-07-31  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (mapi_profile_load),
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_util_modify_recipients),
	(exchange_mapi_util_check_restriction),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_empty_folder),
	(exchange_mapi_rename_folder),
	(exchange_mapi_get_default_folder_id), (exchange_mapi_set_flags),
	(exchange_mapi_remove_items): Code cleanup. 

2008-07-30  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_recipients): Set properties for external
	recipients. 
	(appt_build_name_id), (exchange_mapi_cal_util_build_props): Use 
	AppointmentStateFlags instead of OlMeetingStatus. 
	* exchange-mapi-connection.c 
	(exchange_mapi_util_get_recipients): Use a fallback for PR_SMTP_ADDRESS
	(set_recipient_properties), (exchange_mapi_util_modify_recipients): Add
	a oneoff entry-id for external recipients on the fly. 
	* exchange-mapi-defs.h: Added enum AppointmentStateFlags

2008-07-28  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_mapi_props_to_comp): Add APPT-SEQ to the object.
	(capture_req_props), (update_server_object), (check_server_for_object),
	(exchange_mapi_cal_util_camel_helper): Don't create object on server if 
	it already exists, other important checks to see if object creation is 
	necessary. 
	(appt_build_name_id), (exchange_mapi_cal_util_build_props): Set
	NOT_ALLOW_PROPOSE correctly. 
	(exchange_mapi_cal_util_get_new_appt_id): Utility from backend. 
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-connection.c
	(exchange_mapi_util_check_restriction): API change. Return list of IDs
	if restriction is matched. 
	(exchange_mapi_modify_item), (exchange_mapi_remove_items): Use olFolder
	(exchange_mapi_set_flags): Typo fix
	* exchange-mapi-connection.h: Declaration fix for API change. 
	* exchange-mapi-utils.c (exchange_mapi_debug_property_dump): Use g_print

2008-07-21  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-tz-utils.c
	(exchange_mapi_cal_tz_util_get_mapi_equivalent),
	(exchange_mapi_cal_tz_util_get_ical_equivalent),
	(exchange_mapi_cal_tz_util_destroy),
	(exchange_mapi_cal_tz_util_populate): Don't use the LRU mechanism, 
	always attempt to populate the hash tables if they are empty. 
	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_recipients): Handle the ORGANIZER when
	present in the attendees list as well. 
	(exchange_mapi_cal_util_camel_helper): Fixed memory leak. 
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-connection.c
	(exchange_mapi_util_read_generic_stream): Do some more logging. 

2008-07-17  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_recipients),
	(ical_attendees_from_props),
	(exchange_mapi_cal_util_mapi_props_to_comp),
	(exchange_mapi_cal_util_camel_helper), (appt_build_name_id),
	(exchange_mapi_cal_util_build_props): Added the camel_helper function, 
	some minor changes to how we convert UTC time. 
	* exchange-mapi-cal-utils.h: ABI change in struct cbdata. 
	* exchange-mapi-connection.c: Remove unused macros

2008-07-16  Suman Manjunath  <msuman@novell.com>

	** Have loads of debug messages - helps track program flow.

	* exchange-mapi-connection.c (mapi_profile_load),
	(exchange_mapi_connection_new),
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_util_set_generic_streams),
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments),
	(exchange_mapi_util_get_recipients),
	(exchange_mapi_util_modify_recipients),
	(exchange_mapi_util_check_restriction),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_empty_folder),
	(exchange_mapi_remove_folder), (exchange_mapi_rename_folder),
	(exchange_mapi_util_resolve_named_props),
	(exchange_mapi_util_resolve_named_prop),
	(exchange_mapi_util_create_named_prop),
	(exchange_mapi_get_default_folder_id), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (exchange_mapi_set_flags),
	(mapi_move_items), (exchange_mapi_remove_items),
	(get_child_folders_pf), (get_child_folders),
	(exchange_mapi_get_folders_list),
	(exchange_mapi_get_pf_folders_list):
	* exchange-mapi-connection.h:

	* tz-ical-to-mapi:
	* tz-mapi-to-ical: Calcutta -> Kolkata

2008-07-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c
	(exchange_mapi_cal_util_fetch_attachments),
	(set_attachments_to_cal_component),
	(exchange_mapi_cal_util_mapi_props_to_comp): Get the attachments 
	working again. 
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-utils.c (exchange_lf_to_crlf),
	(exchange_crlf_to_lf): Added these utility functions. (copied from the 
	current Exchange connector). 
	* exchange-mapi-utils.h: Declarations for the same. 

2008-07-09  Suman Manjunath  <msuman@novell.com>

	* Makefile.am: Remove unnecessary linkages, use dynamic linking. 
	* exchange-mapi-cal-utils.h:
	* exchange-mapi-connection.c:
	* exchange-mapi-connection.h:
	* exchange-mapi-folder.c:
	* exchange-mapi-folder.h:
	* exchange-mapi-utils.c:
	* exchange-mapi-utils.h:
	Remove unnecessary headers. 

2008-07-03  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-cal-utils.c (ical_attendees_from_props),
	(exchange_mapi_cal_util_build_props): Changes for modifying 
	appointments/meetings. Minor typo fix. 
	* exchange-mapi-cal-utils.h: 
	* exchange-mapi-utils.c
	(exchange_mapi_util_find_SPropVal_array_propval): Added this utility 
	function. 
	* exchange-mapi-utils.h: Declaration for the same. 

2008-07-03  Johnny Jacob  <jjohnny@novell.com>	
	
	API to empty the contents of the folder. This will *not* delete
	the folder.
	
	* exchange-mapi-connection.ch (exchange_mapi_empty_folder): Added.

2008-07-03  Suman Manjunath  <msuman@novell.com>
	
	** Move the calendar utility files to servers.

	* Makefile.am:
	* exchange-mapi-cal-recur-utils.c (get_ical_weekday),
	(exchange_mapi_cal_util_bin_to_rrule):
	* exchange-mapi-cal-recur-utils.h:
	* exchange-mapi-cal-tz-utils.c
	(exchange_mapi_cal_tz_util_get_mapi_equivalent),
	(exchange_mapi_cal_tz_util_get_ical_equivalent),
	(exchange_mapi_cal_tz_util_destroy), (file_contents_to_hashtable),
	(exchange_mapi_cal_tz_util_populate),
	(exchange_mapi_cal_tz_util_dump_ical_tzs),
	(exchange_mapi_cal_tz_util_dump), (BinToTZDEFINITION),
	(exchange_mapi_cal_util_mapi_tz_to_bin),
	(exchange_mapi_cal_util_bin_to_mapi_tz):
	* exchange-mapi-cal-tz-utils.h:
	* exchange-mapi-cal-utils.c (foo), (get_role_from_type),
	(get_type_from_role), (get_partstat_from_trackstatus),
	(get_trackstatus_from_partstat), (get_transp_from_prop),
	(get_prop_from_transp), (get_taskstatus_from_prop),
	(get_prop_from_taskstatus), (get_class_from_prop),
	(get_prop_from_class), (get_priority_from_prop),
	(get_prop_from_priority),
	(exchange_mapi_cal_util_fetch_attachments),
	(exchange_mapi_cal_util_fetch_recipients),
	(set_attachments_to_cal_component), (ical_attendees_from_props),
	(exchange_mapi_cal_util_generate_globalobjectid), (id_to_string),
	(exchange_mapi_cal_util_mapi_props_to_comp),
	(exchange_mapi_cal_util_build_name_id), (appt_build_name_id),
	(task_build_name_id), (note_build_name_id),
	(exchange_mapi_cal_util_build_props):
	* exchange-mapi-cal-utils.h:
	* tz-ical-to-mapi:
	* tz-mapi-to-ical:
	
2008-06-30  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (mapi_move_items)
	(exchange_mapi_copy_items, exchange_mapi_move_items): Added.

2008-06-29  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_util_modify_recipients): LibMAPI upgrade needed one
	more property to be fetched. 
	(exchange_mapi_util_check_restriction): Added this utility function. 
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): API changes, re-arrange the
	params for better readability. 
	* exchange-mapi-connection.h: Related changes
	* exchange-mapi-defs.h: Added a new enumeration. 

2008-06-26  Johnny Jacob  <jjohnny@novell.com>
	
	* exchange-mapi-connection.c (exchange_mapi_set_flags)
	(get_child_folders_pf): Removed unused variables.

2008-06-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_util_create_named_prop): 
	Changes for struct MAPINAMEID.
	(exchange_mapi_connection_fetch_items): GetContentTable API changed.
	(get_child_folders): Api change fix for GetHierarchyTable.
	(get_child_folders_pf): Api change fix for GetHierarchyTable.

2008-06-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-defs.h (OlEditorType): Removed. Already
	defined in mapidefs.h

2008-06-26  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): Use a single callback type for 
	both fetch_item and fetch_items. 
	(exchange_mapi_util_resolve_named_prop): Added this utility API. 
	* exchange-mapi-connection.h: Related changes. 
	* exchange-mapi-defs.h: Added a new enumeration. 

2008-06-24  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c
	(exchange_mapi_util_resolve_named_props),
	(exchange_mapi_util_create_named_prop):
	Added these two utility functions. 
	* exchange-mapi-connection.h: API declarations for the above.

2008-06-23  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_util_get_recipients),
	(set_recipient_properties), (exchange_mapi_util_modify_recipients),
	(exchange_mapi_create_item), (exchange_mapi_modify_item):
	* exchange-mapi-connection.h:
	API change, re-design of ExchangeMAPIRecipient, related changes. 
	* exchange-mapi-defs.h: Whitespace cleanup
	* exchange-mapi-utils.c (exchange_mapi_util_free_recipient_list): Free
	the SPropValue array for each recipient. 

2008-06-10  Suman Manjunath  <msuman@novell.com>

	* Makefile.am: Added exchange-mapi-defs.h
	* exchange-mapi-connection.c:
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_util_get_recipients),
	(exchange_mapi_util_modify_recipients),
	(exchange_mapi_create_item), (exchange_mapi_modify_item): Use new 
	enumerations from exchange-mapi-defs.h 
	* exchange-mapi-connection.h: Remove ExchangeMAPIRecipientType, use
	OlMailRecipientType instead. 
	* exchange-mapi-defs.h: [new file] Added missing definitions in libmapi.
	* exchange-mapi-utils.c: (exchange_mapi_util_bin_append_uint16),
	(exchange_mapi_util_bin_append_uint32),
	(exchange_mapi_util_bin_append_string),
	(exchange_mapi_util_bin_append_unicode),
	(exchange_mapi_util_bin_append_val),
	(exchange_mapi_util_entryid_generate_oneoff),
	(exchange_mapi_util_entryid_generate_local): New util functions to generate 
	one-off and local entryids. Stolen from the old Exchange connector. 
	* exchange-mapi-utils.h: Declarations for the new util functions. 

2008-06-03  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_util_get_recipients),
	(set_external_recipient), (exchange_mapi_set_recipients),
	(exchange_mapi_create_item): Remove unnecessary preprocessing while 
	setting recipient table. 
	* exchange-mapi-folder.h: Minor type change. 

2008-05-22  Johnny Jacob  <jjohnny@novell.com>	
	* exchange-mapi-connection.c (exchange_mapi_create_item): Added support for 
	generic items support.
	(exchange_mapi_util_set_generic_streams): Added.
	
2008-05-20  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-utils.c: (exchange_mapi_debug_property_dump): Print a 
	readable time-string for PT_SYSTIME while dumping properties array. 

2008-05-16  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (LOGNONE, LOGALL): Fix debug statements.

2008-05-05  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-utils.h: exchange_mapi_debug_property_dump 
	prototype added.

	* exchange-mapi-utils.c (exchange_mapi_debug_property_dump): Added.

2008-05-05  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_rename_folder): 
	Removed uint32_t olFolder.

2008-04-21  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_get_pf_folders_list): Added.
	(get_child_folders_pf): Added. Initial Impl. 

	* exchange-mapi-utils.c: Inserted NULL check.

2008-04-14  Suman Manjunath  <msuman@novell.com>

	** Unblocking all code which can now be used, since the switch to 
	libmapi-0.7 

	* exchange-mapi-connection.c:
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_get_recipients):
	NOTE: Redefined LOGALL() and LOGNONE() since they SEGFAULT on use. 
	Probably due to the update to newer Samba revisions. 
	TODO: Fix this issue (minor).
	* exchange-mapi-utils.c: (exchange_mapi_util_ex_to_smtp):
	* exchange-mapi-utils.h: New API to convert from 'EX' email 
	address-type to 'SMTP' email address-type. 

2008-04-02  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_folder): CreateFolder. 
	Updated to libmapi 371.

2008-02-20  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_util_get_recipients),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item):
	* exchange-mapi-connection.h:

2008-02-15  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_items), 
	(exchange_mapi_connection_fetch_item) : Flags for fetching specified
	content. This should avoid unnecessary stream reading.

	* exchange-mapi-connection.h (_ExchangeMapiOptions): Added. Defines 
	the behaviour of fetch_item(s).

2008-02-07  Suman Manjunath  <msuman@novell.com>

	Re-wrote get_folders_list call to suit the other exposed calls. Fixed 
	a couple of memory leaks in the process. 
	Added a few params to ExchangeMAPIFolder, related changes. 

	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_connection_exists), (exchange_mapi_connection_new),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_remove_folder),
	(exchange_mapi_rename_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (exchange_mapi_remove_items),
	(get_child_folders), (set_default_folders), (set_owner_name),
	(set_user_name), (exchange_mapi_get_folders_list),
	(mapi_set_usernames_RecipientType), (exchange_mapi_set_recipients):
	* exchange-mapi-folder.c: (exchange_mapi_folder_new),
	(exchange_mapi_folder_is_root), (exchange_mapi_peek_folder_list),
	(exchange_mapi_folder_get_folder),
	(exchange_mapi_folder_list_free), (exchange_mapi_folder_list_add):
	* exchange-mapi-folder.h:

2008-02-01  Johnny Jacob  <jjohnny@novell.com>	
	
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item): Donot free
	the attachment list.

	* exchange-mapi-connection.[ch] (struct ExchangeMAPIAttachment): Added 
	mime_type field for attachments.

2008-02-01  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_util_delete_attachments): Implemented the function. 
	(exchange_mapi_util_get_recipients): Implemented the function. 
	(exchange_mapi_util_get_attachments),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): RecipientTable handling. 
	* exchange-mapi-connection.h: Initialize RecipientType enum. 
	* exchange-mapi-folder.h: 
	* exchange-mapi-utils.c: (exchange_mapi_util_free_attachment_list),
	(exchange_mapi_util_free_recipient_list),
	(exchange_mapi_util_free_stream_list): Fixed memory leaks. 
	* exchange-mapi-utils.h: Added (exchange_mapi_util_free_recipient_list)

2008-01-30  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_set_flags): Added.

2008-01-25  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.[ch] (exchange_mapi_rename_folder): Added. 

2008-01-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_create_item),
	(exchange_mapi_modify_item): Call SubmitMessage only if recipients
	are present. 
	* exchange-mapi-utils.c: (exchange_mapi_util_find_stream):
	* exchange-mapi-utils.h: Added a utility function to find an 
	ExchangeMAPIStream in a GList. 

2008-01-02  Johnny Jacob  <jjohnny@novell.com>	
	
	** Support for adding recipients
	
	* exchange-mapi-connection.c (mapi_collate_recipients): Added.
	(exchange_mapi_set_recipient_table): parse recipient list.

	
2007-12-21  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments), (exchange_mapi_create_item), 
	(exchange_mapi_modify_item), (get_child_folders), 
	(exchange_mapi_get_folders_list): Make use of function specific 
	TALLOC_CTX for better re-usability. Related changes. 
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): 
	* exchange-mapi-connection.h: API changes in fetch_item(s) and 
	fetch_item(s)_cb. Added support for using named properties while using
	GetProps. 
	* exchange-mapi-utils.c: (utf8tolinux),
	(exchange_mapi_util_free_attachment_list),
	(exchange_mapi_util_free_stream_list):
	* exchange-mapi-utils.h: New utility functions. 

2007-12-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (exchange_mapi_remove_items),
	(get_child_folders): Code cleanup
	* exchange-mapi-connection.h: API change for fetch_item_cb (added 
	support for attachments and recipients), defined 'struct id_list' 
	used in remove_items.

2007-12-10  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_create_folder),
	(exchange_mapi_remove_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item):
	* exchange-mapi-connection.h: API change for modify_item (added support
	for attachments and recipients); Code cleanup for create_item and
	modify_item.

2007-12-10  Srinivasa Ragavan  <sragavan@novell.com>

	** Fix Suman's build break patch.

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_create_folder):

2007-12-10  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_remove_folder),
	(exchange_mapi_create_folder):
	* exchange-mapi-connection.h: Code cleanup.

2007-12-10  Johnny Jacob  <jjohnny@novell.com>
	
	** Support for 	GetProps in exchange_mapi_connection_fetch_items.
	
	* exchange-mapi-connection.h: Prototype change for fetch_item/fetch_items
	API change.
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item): GetProps
	Support added. Only after successfull openmessage we should do mesg 
	operations. Added GetPropsTagArray.

2007-12-06  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: Add a new parm to fetch items to enable
	to use restrictions fully.
	(exchange_mapi_connection_fetch_items):
	* exchange-mapi-connection.h:

2007-12-05  Suman Manjunath  <msuman@novell.com>

	* Makefile.am: Added two new files: exchange-mapi-utils.[ch]
	* exchange-mapi-connection.c:
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_remove_items), (exchange_mapi_remove_folder),
	(exchange_mapi_create_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (get_child_folders),
	(exchange_mapi_get_folders_list): Added dummy API (to delete attachments), 
	Use utility APIs for inter-converting UIDs and combination of FID, MID
	* exchange-mapi-connection.h:
	* exchange-mapi-utils.c: (exchange_mapi_util_mapi_id_to_string),
	(exchange_mapi_util_mapi_id_from_string),
	(exchange_mapi_util_mapi_ids_to_uid),
	(exchange_mapi_util_mapi_ids_from_uid),
	(exchange_mapi_util_find_row_propval),
	(exchange_mapi_util_find_array_propval):
	* exchange-mapi-utils.h: Added/moved some utility functions to these
	files. 
	
2007-12-05  Suman Manjunath  <msuman@novell.com>

	Removed unnecessary header files.

	* exchange-mapi-connection.c:
	(exchange_mapi_util_find_row_propval),
	(exchange_mapi_util_find_array_propval): Utility functions.
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_connection_fetch_items): Read the PR_BODY (or analogues)
	from relevant streams after proper decoding. Utlity function for reading
	generic streams.
	* exchange-mapi-connection.h: Fixed a couple of compliler warnings, 
	declarations for new APIs added. 

2007-12-04  Srinivasa Ragavan  <sragavan@novell.com>

	** Fixup mapi folders.

	* exchange-mapi-connection.c: (get_child_folders),
	(exchange_mapi_get_folders_list):
	* exchange-mapi-folder.c: (exchange_mapi_folder_new),
	(exchange_mapi_folder_list_free), (exchange_mapi_folder_list_add):
	* exchange-mapi-folder.h:

2007-11-28  Johnny Jacob  <jjohnny@novell.com>	
	
	* exchange-mapi-connection.c (mapi_profile_load): Use proper status enums.
	MAPIUninitialize when profile load fails.
	Removed MapiItemType.

2007-11-27  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-folder.c: (exchange_mapi_peek_folder_list): Make a
	warning than a message.

2007-11-27  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_connection_new): Make the
	close function as void.
	* exchange-mapi-connection.h:

2007-11-27  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-folder.c: (exchange_mapi_peek_folder_list): Let the
	caller worry about authentication.

2007-11-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_new): Redundant connection check.

	* exchange-mapi-connection.h: Added prototype for exchange_mapi_connection_close.

	* exchange-mapi-connection.c (exchange_mapi_connection_close): Added. 

2007-11-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-folder.c (exchange_mapi_peek_folder_list): Check connection 
	and connect before a folder_list call.

	* exchange-mapi-connection.c: Removed MapiItem structs.
	(exchange_mapi_connection_new): Check for connection and load profile.
	(mapi_profile_load): free strings.
	(exchange_mapi_connection_new): call function properly.

2007-11-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_item): Use callbacks only if they
	are available. Null check for build_name_id and build_props.

2007-11-25  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_set_recipient_table): API to set 
	recipient table. Added.

2007-11-23  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_item): Resolve and use
	olFolder if fid is 0.

	* exchange-mapi-folder.c (exchange_mapi_folder_is_root): Utility function Added.
	
	* exchange-mapi-folder.h (ExchangeMAPIFolderType): MAPI_FOLDER_TYPE_NOTE_HOMEPAGE,
	MAPI_FOLDER_TYPE_UNKNOWN Added.

	* exchange-mapi-folder.c (container_class_to_type): Handle unknown types.
	
2007-11-23  Srinivasa Ragavan  <sragavan@novell.com>

	** Implement Create folder.
	* exchange-mapi-connection.c: (exchange_mapi_create_folder),
	(exchange_mapi_get_folders_list):
	* exchange-mapi-connection.h:
	* exchange-mapi-folder.c: (exchange_mapi_container_class):
	* exchange-mapi-folder.h:

2007-11-23  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments): Use macros for specifying 
	max read/write sizes while handling attachment streams.

2007-11-22  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments),
	(exchange_mapi_connection_fetch_item), (exchange_mapi_create_item):
	* exchange-mapi-connection.h: Set attachments implementation. 

2007-11-19  Suman Manjunath  <msuman@novell.com>	

	* exchange-mapi-connection.c: (exchange_mapi_util_get_attachments),
	(exchange_mapi_connection_fetch_items):
	* exchange-mapi-connection.h: Fetch attachments from server. 
	Note: attachments are fetched in (_fetch_items) only atm. 

2007-11-15  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_connection_fetch_items_list) : Removed. 

2007-11-15  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-folder.c: (container_class_to_type):
	* exchange-mapi-folder.h:
	Changed _JOURNAL to _MEMO.

2007-11-13  Suman Manjunath  <msuman@novell.com>
 
 	* exchange-mapi-connection.c:
 	(exchange_mapi_connection_fetch_items),
 	(exchange_mapi_remove_folder): Added missing LOGNONE()s.
 	* exchange-mapi-connection.h: Fixed a compiler warning.
 	* exchange-mapi-folder.c: (exchange_mapi_folder_get_unread_count),
 	(exchange_mapi_folder_get_total_count): unread_count and total_count
 	were incorrectly swapped, fixed it.
	
2007-11-13  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-folder.c (UNLOCK/LOCK): More information on lock macro printfs.

2007-11-02  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items): Fetch all items in the folder, 
	instead of a static value.

2007-11-02  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_create_item), (exchange_mapi_modify_item): Add support
	for modify item

2007-10-29  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_remove_folder):
	* exchange-mapi-folder.c: (exchange_mapi_folder_get_folder):
	* exchange-mapi-folder.h: Fix the implentation for remove folder and
	add api to fetch folder from fid.

2007-10-29  Johnny Jacob  <jjohnny@trantor.blr.novell.com>

	* exchange-mapi-folder.c (exchange_mapi_folder_new): Populate 
	unread and total counts.
	(exchange_mapi_folder_get_unread_count): Added. Utility function.
	(exchange_mapi_folder_get_total_count): Added. Utility function.

	* exchange-mapi-connection.c (get_child_folders): Populate
	ExchangeMAPIFolder with  unread and total count data.

	* exchange-mapi-folder.h (_ExchangeMAPIFolder): Adding new
	fields for folder stats. Change prototype for 
	exchange_mapi_folder_new.

2007-10-29  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-folder.c: (exchange_mapi_peek_folder_list): Have a
	static folder list and serve.
	* exchange-mapi-folder.h:

2007-10-29  Srinivasa Ragavan  <sragavan@novell.com>

	** Put the return types well. 

	* exchange-mapi-connection.c: (exchange_mapi_create_item):
	* exchange-mapi-connection.h:

2007-10-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-folder.c : Added utility functions to retrive
	ExchangeMAPIFolder members.

2007-10-26  Srinivasa Ragavan  <sragavan@novell.com>
	
	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_remove_items), (exchange_mapi_remove_folder),
	(exchange_mapi_create_item), (exchange_mapi_get_folders_list): Add
	function to create items. And make locks and logs easier.
	* exchange-mapi-connection.h:

2007-10-23  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_remove_items): Add logs and fix remove contacts.

2007-10-23  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_remove_items): Add
	implementation for remove items.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_get_folders_list): Fix up the locks again and init the
	msgstores well.

2007-10-22  Sankar P  <psankar@novell.com>

	* Makefile.am:
	* exchange-mapi-connection.c: (utf8tolinux), (get_container_class),
	(get_child_folders), (exchange_mapi_get_folders_list):
	* exchange-mapi-connection.h:
	* exchange-mapi-folder.c: (container_class_to_type),
	(exchange_mapi_folder_new):
	* exchange-mapi-folder.h:

	Moved a few files from the plugin to the servers folder, 
	which is where they are appropriate.

	Now excahange-mapi exposes new header files and hence functions.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_connection_new),
	(exchange_mapi_connection_fetch_item): Make locks verbose and fix more
	locks.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): Unlock after the fetch is over.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	** Initial code drop for the Exchange MAPI provider.

	* Makefile.am:
	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_connection_new), (exchange_mapi_connection_exists),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item):
	* exchange-mapi-connection.h:
	* libexchangemapi.pc.in:
